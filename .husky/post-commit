#!/usr/bin/env sh

echo "ðŸŽ¨ Formatting committed files..."

# Skip if SKIP_POST_COMMIT is set to avoid infinite recursion
if [ -n "$SKIP_POST_COMMIT" ]; then
  exit 0
fi

# Format files changed in the last commit
# Changes remain unstaged for a separate "format" commit
pnpm lint-staged --diff="HEAD~1 HEAD" --config=.lintstagedrc.format.json

if [ $? -eq 0 ]; then
  echo "âœ… Formatting complete. Stage and commit format changes if needed:"
  echo "   $ SKIP_POST_COMMIT=1 git add ."
  echo "   $ SKIP_POST_COMMIT=1 git commit -m 'style: auto-format code'"
fi


